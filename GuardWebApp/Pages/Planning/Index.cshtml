@page
@model GuardWebApp.Pages.Planning.IndexModel
@{
}

@if (ViewData["Step1"] != null)
{
    <div class="row d-flex justify-content-center">
        <div class="col-12">
            <div class="card bg-c-yellow order-card">
                <div class="card-block">
                    <h6 class="m-b-20"></h6>
                    <h2 class="text-right"><i class="fas fa-tasks f-left"></i><span>برنامه ریزی گشت</span></h2>
                    <p class="m-b-0"><span class="f-right"></span></p>
                </div>
            </div>
        </div>
    </div>

    <div>
        <div class="stepper d-flex flex-column mt-5 ml-2">
            <div class="d-flex mb-1">
                <div class="d-flex flex-column pr-4 align-items-center">
                    <div class="rounded-circle py-2 px-3 bg-primary text-white mb-1">1</div>
                    <div class="line h-100"></div>
                </div>
                <div>
                    <h5 class="text-dark">محل گشت</h5>
                    <p class="lead text-muted pb-3">
                        محل گشت یک ناحیه مثل است که خود شامل چند مکان می‌باشد. به طور مثال ساختمان اداری یک محل گشت است که خود شامل چند مکان مانند اتاق های ساختمان می‌باشد
                        <br />
                        اولین قدم در برنامه ریزی گشت، تعیین محل گشت های مورد نظر می‌باشد. برای این منظور می‌توانید از طریق دکمه زیر به صفحه تعریف محل گشت دسترسی پیدا کنید
                        <br />
                        <span class="list-group-item"><a class="dropdown-item" asp-page="/GuardAreaPage/Index"><i class="far fa-map"></i>&nbsp;محل گشت</a></span>
                    </p>
                </div>
            </div>
            <div class="d-flex mb-1">
                <div class="d-flex flex-column pr-4 align-items-center">
                    <div class="rounded-circle py-2 px-3 bg-primary text-white mb-1">2</div>
                    <div class="line h-100"></div>
                </div>
                <div>
                    <h5 class="text-dark">Clone application respository</h5>
                    <p class="lead text-muted pb-3">Go to your dashboard and clone Git respository from the url in the dashboard of your application</p>
                </div>
            </div>
            <div class="d-flex mb-1">
                <div class="d-flex flex-column pr-4 align-items-center">
                    <div class="rounded-circle py-2 px-3 bg-primary text-white mb-1">3</div>
                    <div class="line h-100 d-none"></div>
                </div>
                <div>
                    <h5 class="text-dark">Make changes and push!</h5>
                    <p class="lead text-muted pb-3">Now make changes to your application source code, test it then commit &amp; push</p>
                </div>
            </div>
        </div>
    </div>

}
else if (ViewData["Step2"] != null)
{
    <div class="row d-flex justify-content-center">
        <div class="col-12">
            <div class="card bg-c-yellow order-card">
                <div class="card-block">
                    <h6 class="m-b-20"></h6>
                    <h2 class="text-right"><i class="fas fa-qrcode f-left"></i><span>برنامه ریزی گشت</span></h2>
                    <p class="m-b-0"><span class="f-right"></span></p>
                </div>
            </div>
        </div>
    </div>

    <div>
        <div class="form-group">
            <label class="mr-sm-2" for="inlineFormCustomSelect">محدوده زمان:</label>
            <select class="custom-select mr-sm-2" id="inlineFormCustomSelect" onchange="timetype()">
                <option value="1">از تاریخ - تا تاریخ</option>
                <option value="2">روزانه</option>
                <option value="3">ماهیانه</option>
            </select>
        </div>
    </div>

    <script>
        function timetype() {
            var selectedTime = $("#inlineFormCustomSelect").val();
            if (selectedTime == 1) {
                $("#tofrom").show();
                $("#daily").hide();
                $("#monthly").hide();

            } else if (selectedTime == 2) {
                $("#tofrom").hide();
                $("#daily").show();
                $("#monthly").hide();
            } else if (selectedTime == 3) {
                $("#tofrom").hide();
                $("#daily").hide();
                $("#monthly").show();
            } else {
                $("#tofrom").hide();
                $("#daily").hide();
                $("#monthly").hide();
            }
        }

        function checkmax30days(evt) {
            if (daysBetween($("input[name=sDate]").val(), $("input[name=eDate]").val()) > 31) {
                alert("محدوده زمانی حداکثر 31 روز میباشد");
                evt.preventDefault();
                evt.returnValue = false;
                return false;
            }
            return true;
        }

        function treatAsUTC(date) {
            var result = new Date(date);
            result.setMinutes(result.getMinutes() - result.getTimezoneOffset());
            return result;
        }

        function daysBetween(startDate, endDate) {
            var millisecondsPerDay = 24 * 60 * 60 * 1000;
            return (treatAsUTC(endDate) - treatAsUTC(startDate)) / millisecondsPerDay;
        }


    </script>

    <div id="tofrom" style="display:block">
        <form onsubmit="checkmax30days(event)" asp-page-handler="Date" method="post">
            <input type="hidden" name="timetype" value="tofrom" />
            <div class="form-group">
                <label>تاریخ شروع:</label>
                <input name="sDate" type="datetime-local" class="form-control">
            </div>
            <div class="form-group">
                <label>تاریخ پایان:</label>
                <input name="eDate" type="datetime-local" class="form-control">
            </div>
            <button type="submit" class="btn btn-primary">ثبت</button>
        </form>
    </div>

    <div id="daily" style="display:none">
        <form asp-page-handler="Date" method="post">
            <input type="hidden" name="timetype" value="daily" />
            <div class="form-group">
                <label>روز :</label>
                <input name="sDate" type="datetime-local" class="form-control">
            </div>
            <button type="submit" class="btn btn-primary">ثبت</button>
        </form>
    </div>

    <div id="monthly" style="display:none">
        <form asp-page-handler="Date" method="post">
            <input type="hidden" name="timetype" value="monthly" />
            <div class="form-group">
                <label>ماه:</label>
                <select class="form-control" name="sDate">
                    <option value="1">فروردین</option>
                    <option value="2">اردیبهشت</option>
                    <option value="3">خرداد</option>
                    <option value="4">تیر</option>
                    <option value="5">مرداد</option>
                    <option value="6">شهریور</option>
                    <option value="7">مهر</option>
                    <option value="8">آبان</option>
                    <option value="9">آذر</option>
                    <option value="10">دی</option>
                    <option value="11">بهمن</option>
                    <option value="12">اسفند</option>
                </select>
            </div>
            <button type="submit" class="btn btn-primary">ثبت</button>
        </form>
    </div>
}
else if (ViewData["Step3"] != null)
{
    <div class="row d-flex justify-content-center">
        <div class="col-12">
            <div class="card bg-c-yellow order-card">
                <div class="card-block">
                    <h6 class="m-b-20"></h6>
                    <h2 class="text-right"><i class="fas fa-qrcode f-left"></i><span>برنامه ریزی گشت</span></h2>
                    <p class="m-b-0"><span class="f-right"></span></p>
                </div>
            </div>
        </div>
    </div>

    <div class="alert alert-success">
        تاریخ انتخابی:
        از: <div class="form-control">@Model.startDate</div>
        تا: <div class="form-control">@Model.endDate</div>
    </div>
    <br />
    <br />
    <div class="alert alert-info">
        لیست پلن پر شد
    </div>
}
